<!DOCTYPE html>
<html>
  <head>
    <title>EH Member Point Tracker Excom</title>

    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css">

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
  <div id="layout">
    
    <a href="#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
    </a>

    <div id="menu">
        <div class="pure-menu">
            <a class="pure-menu-heading" href="#">EH</a>
            <% if logged_in? %>
            <ul class="pure-menu-list">
                <li class="pure-menu-item"><a href="/welcome" class="pure-menu-link">Home</a></li>
                <li class="pure-menu-item"><a href="/profile" class="pure-menu-link">Profile</a></li>
                <li class="pure-menu-item"><a href="/activities" class="pure-menu-link">Activities</a></li>
                <li class="pure-menu-item"><a href="/contact" class="pure-menu-link">Contact</a></li>
            </ul>
            <% end %>
        </div>
    </div>

    <%= yield %>

    <script>
    (function(window, document) {

      let layout   = document.getElementById('layout'),
          menu     = document.getElementById('menu'),
          menuLink = document.getElementById('menuLink');

      function toggleClass(element, className) {
          let classes = element.className.split(/\s+/),
              length = classes.length,
              i = 0;

          for (; i < length; i++) {
              if (classes[i] === className) {
                  classes.splice(i, 1);
                  break;
              }
          }
          // The className is not found
          if (length === classes.length) {
              classes.push(className);
          }

          element.className = classes.join(' ');
      }

      function toggleAll(e) {
          let active = 'active';

          e.preventDefault();
          toggleClass(layout, active);
          toggleClass(menu, active);
          toggleClass(menuLink, active);
      }
      
      function handleEvent(e) {
          if (e.target.id === menuLink.id) {
              return toggleAll(e);
          }
          
          if (menu.className.indexOf('active') !== -1) {
              return toggleAll(e);
          }
      }
      
      document.addEventListener('click', handleEvent);

    }(this, this.document));
    </script>

  </div>
  </body>
</html>
